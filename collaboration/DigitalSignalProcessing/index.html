<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Signal Filters Design Based on Digital Signal Processing - Zhihao Li - Zhihao Li&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="Zhihao Li - Zhihao Li&#039;s Blog"><meta name="msapplication-TileImage" content="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/blog/profile/logo_light.png"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Zhihao Li - Zhihao Li&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="This project is developed about how to process digital signals perfectly and design very useful signal filters."><meta property="og:type" content="blog"><meta property="og:title" content="Signal Filters Design Based on Digital Signal Processing"><meta property="og:url" content="https://lzhms.github.io/collaboration/DigitalSignalProcessing/"><meta property="og:site_name" content="Zhihao Li - Zhihao Li&#039;s Blog"><meta property="og:description" content="This project is developed about how to process digital signals perfectly and design very useful signal filters."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/covers/xdu/wp9391562-music-wave-wallpapers.jpg"><meta property="article:published_time" content="2023-10-24T06:40:14.000Z"><meta property="article:modified_time" content="2024-11-30T15:29:16.171Z"><meta property="article:author" content="Zhihao Li"><meta property="article:tag" content="Collaboration Project"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/covers/xdu/wp9391562-music-wave-wallpapers.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzhms.github.io/collaboration/DigitalSignalProcessing/"},"headline":"Signal Filters Design Based on Digital Signal Processing","image":["https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/covers/xdu/wp9391562-music-wave-wallpapers.jpg"],"datePublished":"2023-10-24T06:40:14.000Z","dateModified":"2024-11-30T15:29:16.171Z","author":{"@type":"Person","name":"Zhihao Li"},"publisher":{"@type":"Organization","name":"Zhihao Li - Zhihao Li's Blog","logo":{"@type":"ImageObject","url":"https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/blog/profile/logo_light.png"}},"description":"This project is developed about how to process digital signals perfectly and design very useful signal filters."}</script><link rel="canonical" href="https://lzhms.github.io/collaboration/DigitalSignalProcessing/"><link rel="icon" href="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/blog/profile/logo_light.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link rel="stylesheet" href="/css/icons/iconfont.css"><link data-pjax rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.7.0/style.css"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/blog/profile/logo_light.png" alt="Zhihao Li - Zhihao Li&#039;s Blog" height="28"><img class="logo-img-dark" src="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/blog/profile/logo_dark.png" alt="Zhihao Li - Zhihao Li&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">ZHIHAO LI&#039;S LOG BOOK</a><a class="navbar-item" href="/blog">BLOG</a><a class="navbar-item" href="/knowledge">KNOWLEDGE</a><a class="navbar-item" href="/publications">PUBLICATIONS</a><a class="navbar-item" href="/projects">PROJECTS</a><a class="navbar-item" href="/essay">ESSAY</a><a class="navbar-item" href="/readings">READINGS</a><a class="navbar-item" href="/collaboration">COLLABORATION</a><a class="navbar-item" href="/archives">ARCHIVES</a><a class="navbar-item" href="/categories">CATEGORIES</a><a class="navbar-item" href="/tags">TAGS</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/LZHMS"><i class="iconfont icon-github"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/LZHMS"><i class="iconfont icon-gitee1"></i></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/covers/xdu/wp9391562-music-wave-wallpapers.jpg" alt="Signal Filters Design Based on Digital Signal Processing"></span></div><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">Signal Filters Design Based on Digital Signal Processing</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="2023-10-24T06:40:14.000Z" title="2023-10-24T06:40:14.000Z">2023-10-24</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="2024-11-30T15:29:16.171Z" title="2024-11-30T15:29:16.171Z">2024-11-30</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/collaboration/">collaboration</a></span><span class="level-item"><i class="far fa-clock"></i> 28 minutes read (About 4153 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><div class="content"><h2 id="Thoeries"><a href="#Thoeries" class="headerlink" title="Thoeries"></a>Thoeries</h2><h3 id="I-Fourier-Series-Expansion-Algorithm"><a href="#I-Fourier-Series-Expansion-Algorithm" class="headerlink" title="I. Fourier Series Expansion Algorithm"></a>I. Fourier Series Expansion Algorithm</h3><p>We can utilize the Fourier Series to produce the analog signal with some frequency components. For any signal, its Fourier series expansion is defined as</p>
<p>$$<br>x(t) &#x3D; \frac{A_0}{2}+\sum_{n&#x3D;1}^{\infty}A_n\cos(n\Omega t+\varphi_n)<br>$$</p>
<p>In the equation，$\frac{A_0}{2}$ represents the DC component, $A_1\cos(\Omega t+\varphi_1)$, represents the fundamental component of the signal, $A_n\cos(n\Omega t+\varphi_n)$ represents the nth harmonic component of the signal. Moreover, analog angular frequency $\Omega &#x3D; \frac{2\pi}{T}&#x3D;2\pi f$.<br>Therefore, in this project we select three different frequency components, that is $f_1, f_2, f_3$, to synthesize the final required analog signal:</p>
<p>$$<br>x(t) &#x3D; \frac{A_0}{2}+A_1\cos(2\pi f_1t+\varphi_1)+A_2\cos(2\times 2\pi f_2t+\varphi_2)+A_3\cos(3\times 2\pi f_3t+\varphi_3)<br>$$</p>
<p>For simplicity, there we respectively select these values:</p>
<center>$A_0=0, A_1=1, A_2=1, A_3=1$</center>
$$
\varphi_1=\varphi_2=\varphi_3=0
$$
Following above expression, we can get the generated analog signal:
$$
x(t) = \cos(2\pi f_1t)+\cos(4\pi f_2t)+\cos(6\pi f_3t)
$$

<h3 id="II-Sample-the-Analog-Signal"><a href="#II-Sample-the-Analog-Signal" class="headerlink" title="II. Sample the Analog Signal"></a>II. Sample the Analog Signal</h3><h4 id="Time-Domain-Sampling-Theorem"><a href="#Time-Domain-Sampling-Theorem" class="headerlink" title="Time Domain Sampling Theorem"></a>Time Domain Sampling Theorem</h4><p>According to the time domain sampling theorem, the sampling frequency must be greater than twice the signal cutoff frequency.<br>Let’s assume that the sampling frequency is $F_s$, and the generated analog signal frequency satisfies: $F_1&lt;F_2&lt;F_3$, so the signal cutoff frequency is $F_c &#x3D; F_3$. The sampling theorem is formally expressed as:</p>
<p>$$<br>F_s &gt; 2F_c<br>$$</p>
<p>In this experiment，we respectively selected $F_1&#x3D;10Hz, F_2&#x3D;20Hz, F_3&#x3D;30Hz$ to produce analog signal. So we can get the period and cutoff frequency of sampled signal:</p>
<p>$$<br>T_c &#x3D; \frac{1}{F_1}&#x3D;0.1s, F_c &#x3D; F_3 &#x3D; 30Hz<br>$$</p>
<h4 id="Time-domain-Window"><a href="#Time-domain-Window" class="headerlink" title="Time-domain Window"></a>Time-domain Window</h4><p>For periodic continuous signals, we intercept at integer multiples of the period to obtain a sequence for spectrum analysis.</p>
<p>$$<br>T_p&#x3D;N*T_c, N\in Z^+<br>$$</p>
<h4 id="Sampling-Frequency"><a href="#Sampling-Frequency" class="headerlink" title="Sampling Frequency"></a>Sampling Frequency</h4><p>For a specific sampling frequency, we can get the sampling period $T_s$, and the number of sampling points $N$:</p>
<p>$$<br>T_s &#x3D; \frac{1}{F_s}, N&#x3D;T_p*F_c<br>$$</p>
<p>Therefore, we use sampling frequency of $F_s&#x3D;90Hz, F_s&#x3D;60Hz, F_s&#x3D;40Hz$ to get time-domain signals.</p>
<h4 id="Spectral-Resolution"><a href="#Spectral-Resolution" class="headerlink" title="Spectral Resolution"></a>Spectral Resolution</h4><p>Spectral resolution is defined as the minimum separation between two signals of different frequencies:</p>
<p>$$<br>\Delta f &#x3D; \frac{F_s}{N}&#x3D;\frac{1}{NT_s}&#x3D;\frac{1}{T_p}<br>$$</p>
<h3 id="III-Spectral-Analysis"><a href="#III-Spectral-Analysis" class="headerlink" title="III. Spectral Analysis"></a>III. Spectral Analysis</h3><p>In this section, we will analyse the Amplitude-Frequency Characteristics and Phase-Frequency Characteristics of the sampled signal.</p>
<h4 id="Convert-to-Frequency"><a href="#Convert-to-Frequency" class="headerlink" title="Convert to Frequency"></a>Convert to Frequency</h4><p>When analysing the spectral, we need to convert the $0\sim N-1$ to frequency sequence:</p>
<p>$$<br>f_k &#x3D; k*\frac{F_s}{N}, k&#x3D;0,1,…N-1<br>$$</p>
<h4 id="Convert-to-Real-Amplitude"><a href="#Convert-to-Real-Amplitude" class="headerlink" title="Convert to Real Amplitude"></a>Convert to Real Amplitude</h4><p>After we apply Discrete Fourier Transform to the sampled signal, the frequency-domain signal is complex-valued. And due to the time-domain signal is real-valued, the the frequency-domain signal is conjugate symmetric:</p>
<p>$$<br>X(k) &#x3D; X^*(N-k), k&#x3D;0,1,…N-1<br>$$</p>
<p>For complex values, that means its real part is even symmetric about the middle point, and its imaginary part is odd symmetric about the middle point. This will be showed in the following figures.</p>
<h2 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h2><h3 id="Experiment-I-T-p-3T-c-F-s-90-Hz"><a href="#Experiment-I-T-p-3T-c-F-s-90-Hz" class="headerlink" title="Experiment I: $T_p&#x3D;3T_c, F_s&#x3D;90$Hz"></a>Experiment I: $T_p&#x3D;3T_c, F_s&#x3D;90$Hz</h3><ul>
<li>Samping Frequency $F_s &#x3D; 3F_c(F_s &gt; 2F_c)$<br>We use the sampling frequency of $F_s&#x3D;90$Hz under the condition of $T_p&#x3D;3T_c$.<img src="https://cdn.jsdelivr.net/gh/LZHMS/picx-images-hosting@master/EBlog/Courses/Np3_90Hz_Sampling.qkarodnm2tc.png" alt="Sampled Signal" width="50%"/>
<img src="https://cdn.jsdelivr.net/gh/LZHMS/picx-images-hosting@master/EBlog/Courses/Np3_90Hz_DFT.1oearbvg9zq8.webp" alt="Spectral Analysis Graph" width="50%"/></li>
<li>Conclusions<br>The sampling frequency satisfies the Time Domain Sampling Theorem so we can see there is no overlap in frequency domain about the amplitude-frequency characteristic. And when $f&#x3D;10$Hz, $f&#x3D;20$Hz, $f&#x3D;30$Hz, we can get the amplitude very close to $1$ which is us defined in analop signal.</li>
</ul>
<h3 id="Experiment-II-T-p-3T-c-F-s-60-Hz"><a href="#Experiment-II-T-p-3T-c-F-s-60-Hz" class="headerlink" title="Experiment II: $T_p&#x3D;3T_c, F_s&#x3D;60$Hz"></a>Experiment II: $T_p&#x3D;3T_c, F_s&#x3D;60$Hz</h3><ul>
<li>Samping Frequency $F_s &#x3D; 2F_c(F_s &#x3D; 2F_c)$<br>We use the sampling frequency of $F_s&#x3D;60$Hz under the condition of $T_p&#x3D;3T_c$.<img src="https://cdn.jsdelivr.net/gh/LZHMS/picx-images-hosting@master/EBlog/Courses/Np3_60Hz_Sampling.6gd816c8cxg0.png" alt="Sampled Signal" width="50%"/>
<img src="https://cdn.jsdelivr.net/gh/LZHMS/picx-images-hosting@master/EBlog/Courses/Np3_60Hz_DFT.57gxppdnrrg0.webp" alt="Spectral Analysis Graph" width="50%"/></li>
<li>Conclusions<br>The sampling frequency equals the threhold of Time Domain Sampling Theorem so we can easily see that it will just become overlapping in frequency domain. And when $f&#x3D;30$Hz that is also $F_s&#x2F;2$ point, we can get this point very close to its symmetric frequency point.</li>
</ul>
<h3 id="Experiment-III-T-p-3T-c-F-s-40-Hz"><a href="#Experiment-III-T-p-3T-c-F-s-40-Hz" class="headerlink" title="Experiment III: $T_p&#x3D;3T_c, F_s&#x3D;40$Hz"></a>Experiment III: $T_p&#x3D;3T_c, F_s&#x3D;40$Hz</h3><ul>
<li>Samping Frequency $F_s &#x3D; \frac{4}{3}F_c(F_s &lt; 2F_c)$<br>We use the sampling frequency of $F_s&#x3D;40$Hz under the condition of $T_p&#x3D;3T_c$.<img src="https://cdn.jsdelivr.net/gh/LZHMS/picx-images-hosting@master/EBlog/Courses/Np3_40Hz_Sampling.48kfqsokcha0.webp" alt="Sampled Signal" width="50%"/>
<img src="https://cdn.jsdelivr.net/gh/LZHMS/picx-images-hosting@master/EBlog/Courses/Np3_40Hz_DFT.kf1tgvtvhgg.webp" alt="Spectral Analysis Graph" width="50%"/></li>
<li>Conclusions<br>The sampling frequency do not equal the Time Domain Sampling Theorem so we can obviously see that it has discarded the third frequency $f&#x3D;30$Hz, which is caused by overlapping in frequency domain.</li>
</ul>
<p>Note: in order to clearly analyse spectral of sampled signal, we also select the Time-domain Window of $T_p&#x3D;50T_c$ to conduct experiments.</p>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><img src="https://cdn.jsdelivr.net/gh/LZHMS/picx-images-hosting@master/EBlog/Courses/2.tnk4hwphuh.webp"/>

<h2 id="Codes"><a href="#Codes" class="headerlink" title="Codes"></a>Codes</h2><figure class="highlight matlab"><figcaption><span>main</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% Project Introduction:</span></span><br><span class="line"><span class="comment">%   This project is developed to design some signal filters based on digital</span></span><br><span class="line"><span class="comment">% signal processing.</span></span><br><span class="line">clear, close all;</span><br><span class="line"><span class="comment">%% Produce and sample digital signal</span></span><br><span class="line">f1 = <span class="number">10</span>;</span><br><span class="line">f2 = <span class="number">20</span>;</span><br><span class="line">f3 = <span class="number">30</span>;    <span class="comment">% so the fc = f3 = 30Hz</span></span><br><span class="line">Np = <span class="number">50</span>;          <span class="comment">% number of periods for time-domain window</span></span><br><span class="line"><span class="comment">%% Experiment 1 (Choosing samling frequency fs = 3fc (fs &gt; 2fs))</span></span><br><span class="line">fs1 = <span class="number">90</span>;          <span class="comment">% sampling frequency</span></span><br><span class="line">xn1 = ProduceSamplingSignal(f1, f2, f3, fs1, Np, <span class="string">&#x27;Sampling Analog Signal(fs = 3fc)&#x27;</span>);</span><br><span class="line">DFTAnalysis(xn1, fs1, <span class="string">&#x27;Frequency Response Characteristics(fs = 3fc)&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% Experiment 2 (Choosing samling frequency fs = 2fc)</span></span><br><span class="line">fs2 = <span class="number">60</span>;          <span class="comment">% sampling frequency</span></span><br><span class="line">xn2 = ProduceSamplingSignal(f1, f2, f3, fs2, Np, <span class="string">&#x27;Sampling Analog Signal(fs = 2fc)&#x27;</span>);</span><br><span class="line">DFTAnalysis(xn2, fs2, <span class="string">&#x27;Frequency Response Characteristics(fs = 2fc)&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% Experiment 3 (Choosing samling frequency fs &lt; 2fc)</span></span><br><span class="line">fs3 = <span class="number">40</span>;          <span class="comment">% sampling frequency</span></span><br><span class="line">xn3 = ProduceSamplingSignal(f1, f2, f3, fs3, Np, <span class="string">&#x27;Sampling Analog Signal(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line">DFTAnalysis(xn3, fs3, <span class="string">&#x27;Frequency Response Characteristics(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% Experiment Description</span></span><br><span class="line"><span class="comment">% Experiment 4-7: Design a digital filter respectively with band pass, high</span></span><br><span class="line"><span class="comment">% pass, low pass, band stop based on ellipord.</span></span><br><span class="line"><span class="comment">%% Experiment 4: Design a digital filter with band pass using ellipord</span></span><br><span class="line">fpl = <span class="number">15</span>; fpu=<span class="number">25</span>; fsl=<span class="number">13</span>; fsu=<span class="number">28</span>;</span><br><span class="line">rp = <span class="number">1</span>;           </span><br><span class="line">rs = <span class="number">40</span>;</span><br><span class="line">ellipBandPass(fpl, fpu, fsl, fsu, rp, rs, xn1, fs1, f1, Np, <span class="string">&#x27;Digital Filter With Band Pass Using Ellipord(fs = 3fc)&#x27;</span>);</span><br><span class="line">ellipBandPass(fpl, fpu, fsl, fsu, rp, rs, xn2, fs2, f1, Np, <span class="string">&#x27;Digital Filter With Band Pass Using Ellipord(fs = 2fc)&#x27;</span>);</span><br><span class="line">ellipBandPass(<span class="number">8</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, rp, rs, xn3, fs3, f1, Np, <span class="string">&#x27;Digital Filter With Band Pass Using Ellipord(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% Experiment 5: Design a digital filter with high pass using ellipord</span></span><br><span class="line">fpz = <span class="number">16</span>; fsz = <span class="number">13</span>;</span><br><span class="line">rp = <span class="number">1</span>;           </span><br><span class="line">rs = <span class="number">40</span>;</span><br><span class="line">ellipHighPass(fpz, fsz, rp, rs, xn1, fs1, f1, Np, <span class="string">&#x27;Digital Filter With High Pass Using Ellipord(fs = 3fc)&#x27;</span>);</span><br><span class="line">ellipHighPass(fpz, fsz, rp, rs, xn2, fs2, f1, Np, <span class="string">&#x27;Digital Filter With High Pass Using Ellipord(fs = 2fc)&#x27;</span>);</span><br><span class="line">ellipHighPass(<span class="number">15</span>, <span class="number">12</span>, rp, rs, xn3, fs3, f1, Np, <span class="string">&#x27;Digital Filter With High Pass Using Ellipord(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% Experiment 6: Design a digital filter with low pass using ellipord</span></span><br><span class="line">fpz = <span class="number">23</span>; fsz=<span class="number">28</span>; </span><br><span class="line">rp = <span class="number">1</span>;           </span><br><span class="line">rs = <span class="number">40</span>;</span><br><span class="line">ellipLowPass(fpz, fsz, rp, rs, xn1, fs1, f1, Np, <span class="string">&#x27;Digital Filter With Low Pass Using Ellipord(fs = 3fc)&#x27;</span>);</span><br><span class="line">ellipLowPass(fpz, fsz, rp, rs, xn2, fs2, f1, Np, <span class="string">&#x27;Digital Filter With Low Pass Using Ellipord(fs = 2fc)&#x27;</span>);</span><br><span class="line">ellipLowPass(<span class="number">12</span>, <span class="number">15</span>, rp, rs, xn3, fs3, f1, Np, <span class="string">&#x27;Digital Filter With Low Pass Using Ellipord(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% Experiment 7: Design a digital filter with band stop using ellipord</span></span><br><span class="line">fpl = <span class="number">15</span>; fpu=<span class="number">25</span>; fsl=<span class="number">17</span>; fsu=<span class="number">22</span>;</span><br><span class="line">rp = <span class="number">1</span>;           </span><br><span class="line">rs = <span class="number">40</span>;</span><br><span class="line">ellipBandStop(fpl, fpu, fsl, fsu, rp, rs, xn1, fs1, f1, Np, <span class="string">&#x27;Digital Filter With Band Stop Using Ellipord(fs = 3fc)&#x27;</span>);</span><br><span class="line">ellipBandStop(fpl, fpu, fsl, fsu, rp, rs, xn2, fs2, f1, Np, <span class="string">&#x27;Digital Filter With Band Stop Using Ellipord(fs = 2fc)&#x27;</span>);</span><br><span class="line">ellipBandStop(<span class="number">5</span>, <span class="number">17</span>, <span class="number">8</span>, <span class="number">12</span>, rp, rs, xn3, fs3, f1, Np, <span class="string">&#x27;Digital Filter With Band Stop Using Ellipord(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">%% Experiment Description</span></span><br><span class="line"><span class="comment">% Experiment 8-11: Design a digital filter respectively with high pass, low</span></span><br><span class="line"><span class="comment">% pass, band pass, band stop based on hamming window.</span></span><br><span class="line"><span class="comment">%% Experiment 8: Design a digital filter with high pass using hamming window</span></span><br><span class="line">fpz = <span class="number">16</span>; fsz = <span class="number">13</span>;</span><br><span class="line">firlHighPass(fpz, fsz, xn1, fs1, f1, Np, <span class="string">&#x27;Digital Filter With High Pass Using Hamming Window(fs = 3fc)&#x27;</span>);</span><br><span class="line">firlHighPass(fpz, fsz, xn2, fs2, f1, Np, <span class="string">&#x27;Digital Filter With High Pass Using Hamming Window(fs = 2fc)&#x27;</span>);</span><br><span class="line">firlHighPass(<span class="number">15</span>, <span class="number">12</span>, xn3, fs3, f1, Np, <span class="string">&#x27;Digital Filter With High Pass Using Hamming Window(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line"><span class="comment">%% Experiment 9: Design a digital filter with low pass using hamming window</span></span><br><span class="line">fpz = <span class="number">23</span>; fsz = <span class="number">28</span>;</span><br><span class="line">firlLowPass(fpz, fsz, xn1, fs1, f1, Np, <span class="string">&#x27;Digital Filter With Low Pass Using Hamming Window(fs = 3fc)&#x27;</span>);</span><br><span class="line">firlLowPass(fpz, fsz, xn2, fs2, f1, Np, <span class="string">&#x27;Digital Filter With Low Pass Using Hamming Window(fs = 2fc)&#x27;</span>);</span><br><span class="line">firlLowPass(<span class="number">13</span>, <span class="number">17</span>, xn3, fs3, f1, Np, <span class="string">&#x27;Digital Filter With Low Pass Using Hamming Window(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line"><span class="comment">%% Experiment 10: Design a digital filter with band pass using hamming window</span></span><br><span class="line">fpl = <span class="number">15</span>; fpu = <span class="number">25</span>;</span><br><span class="line">firlBandPass(fpl, fpu, xn1, fs1, f1, Np, <span class="string">&#x27;Digital Filter With Band Pass Using Hamming Window(fs = 3fc)&#x27;</span>);</span><br><span class="line">firlBandPass(fpl, fpu, xn2, fs2, f1, Np, <span class="string">&#x27;Digital Filter With Band Pass Using Hamming Window(fs = 2fc)&#x27;</span>);</span><br><span class="line">firlBandPass(<span class="number">7</span>, <span class="number">15</span>, xn3, fs3, f1, Np, <span class="string">&#x27;Digital Filter With Band Pass Using Hamming Window(fs &lt; 2fc)&#x27;</span>);</span><br><span class="line"><span class="comment">%% Experiment 11: Design a digital filter with band stop using hamming window</span></span><br><span class="line">fsl = <span class="number">15</span>; fsu = <span class="number">25</span>;</span><br><span class="line">firlBandStop(fsl, fsu, xn1, fs1, f1, Np, <span class="string">&#x27;Digital Filter With Band Stop Using Hamming Window(fs = 3fc)&#x27;</span>);</span><br><span class="line">firlBandStop(fsl, fsu, xn2, fs2, f1, Np, <span class="string">&#x27;Digital Filter With Band Stop Using Hamming Window(fs = 2fc)&#x27;</span>);</span><br><span class="line">firlBandStop(<span class="number">7</span>, <span class="number">15</span>, xn3, fs3, f1, Np, <span class="string">&#x27;Digital Filter With Band Band Stop Hamming Window(fs &lt; 2fc)&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>ProduceSamplingSignal</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xn</span> = <span class="title">ProduceSamplingSignal</span><span class="params">(f1, f2, f3, fs, Np, Alltitle)</span></span></span><br><span class="line"><span class="comment">% Function Description: </span></span><br><span class="line"><span class="comment">%        We want to make a digital signal composed of three frequency</span></span><br><span class="line"><span class="comment">%        components and sample the produced signal.</span></span><br><span class="line"><span class="comment">% Inputs: </span></span><br><span class="line"><span class="comment">%        f1, f2, f3: means our selected frequency components, fs</span></span><br><span class="line"><span class="comment">%            represents the sampling frequency.</span></span><br><span class="line"><span class="comment">%        Np: means the number of periods.</span></span><br><span class="line"><span class="comment">% Outputs:</span></span><br><span class="line"><span class="comment">%        xn: represents the sampled signal.</span></span><br><span class="line"></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    <span class="comment">% t = 0: 0.0001: T;     % analog time sequence</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">% Step I: Produce digital signal</span></span><br><span class="line">    xt = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f1*t) + <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f2*t) + <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f3*t);</span><br><span class="line">    <span class="comment">% Step II: Sample produced signal</span></span><br><span class="line">    xn = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f1*t) + <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f2*t) + <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f3*t);</span><br><span class="line"></span><br><span class="line">    <span class="comment">% Step III: Visualize produced signal and sampled signal</span></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">plot</span>(t, xt);</span><br><span class="line">    title(<span class="string">&#x27;Time-domain signal $x(t)$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;$t/s$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-2.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    grid on</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    stem(t, xn);</span><br><span class="line">    title(<span class="string">&#x27;Time-domain sampled signal $x(n)$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;$t/s$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-2.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    grid on</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>DFTAnalysis</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DFTAnalysis</span><span class="params">(xn, fs, Alltitle)</span></span></span><br><span class="line"><span class="comment">% Function Description:</span></span><br><span class="line"><span class="comment">%       This function calculates the DFT[x(n)] and do spectral analysis.</span></span><br><span class="line"><span class="comment">% Inputs:</span></span><br><span class="line"><span class="comment">%       xn: digital discrete signal</span></span><br><span class="line"><span class="comment">%       fs: sampling frequency</span></span><br><span class="line"><span class="comment">% Outputs:</span></span><br><span class="line"><span class="comment">%       No return</span></span><br><span class="line"></span><br><span class="line">    N = <span class="built_in">length</span>(xn);    <span class="comment">% number of sampling points</span></span><br><span class="line">    df = fs / N;       <span class="comment">% spectral resolution</span></span><br><span class="line">    f1 = (<span class="number">0</span>:N<span class="number">-1</span>)*df;    <span class="comment">% tranverse to the frequncy sequence</span></span><br><span class="line">    f2 =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line">    <span class="comment">% DFT using FFT algorithm</span></span><br><span class="line">    Xk = fft(xn, N);   </span><br><span class="line">    <span class="comment">% Tranverse to the real amplitude</span></span><br><span class="line">    RM = <span class="number">2</span>*<span class="built_in">abs</span>(Xk)/N;</span><br><span class="line">    Angle = <span class="built_in">angle</span>(Xk);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    <span class="comment">% Amplitude-Frequency Characteristics</span></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    stem(f1, RM,<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    title(<span class="string">&#x27;Amplitude-Frequency Characteristics&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;$f$/Hz&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% Phase-Frequency Characteristics</span></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    stem(f1, Angle,<span class="string">&#x27;.&#x27;</span>); </span><br><span class="line">    line([(N<span class="number">-1</span>)*df, <span class="number">0</span>],[<span class="number">0</span>,<span class="number">0</span>]);</span><br><span class="line">    title(<span class="string">&#x27;Phase-Frequency Characteristics&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;$f$/Hz&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    <span class="comment">% Amplitude-Frequency Characteristics</span></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">    <span class="built_in">plot</span>(f2, <span class="built_in">abs</span>(Xk));</span><br><span class="line">    title(<span class="string">&#x27;Amplitude-Frequency Characteristics&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% Phase-Frequency Characteristics</span></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line">    <span class="built_in">plot</span>(f2, Angle);</span><br><span class="line">    title(<span class="string">&#x27;Phase-Frequency Characteristics&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>ellipBandPass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ellipBandPass</span><span class="params">(fpl, fpu, fsl, fsu, rp, rs, x, fs, f1, Np, Alltitle)</span></span></span><br><span class="line">    wp = [<span class="number">2</span>*fpl/fs, <span class="number">2</span>*fpu/fs];</span><br><span class="line">    ws = [<span class="number">2</span>*fsl/fs, <span class="number">2</span>*fsu/fs];</span><br><span class="line">    [N, wn] = ellipord(wp, ws, rp, rs);    <span class="comment">% 获取阶数和截止频率</span></span><br><span class="line">    [B, A] = ellip(N, rp, rs, wn, <span class="string">&#x27;bandpass&#x27;</span>);         <span class="comment">% 获得转移函数系数</span></span><br><span class="line"></span><br><span class="line">    filter_bp_s = filter(B, A, x);</span><br><span class="line">    X_bp_s = <span class="built_in">abs</span>(fft(filter_bp_s));</span><br><span class="line">    X_bp_s_angle = <span class="built_in">angle</span>(fft(filter_bp_s));</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% plot the graphs  </span></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    N = <span class="built_in">length</span>(x);    <span class="comment">% number of sampling points</span></span><br><span class="line">    f =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line"></span><br><span class="line">    <span class="comment">% 带通滤波器频谱特性</span></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>]);</span><br><span class="line">    M = <span class="number">512</span>;</span><br><span class="line">    wk = <span class="number">0</span>:<span class="built_in">pi</span>/M:<span class="built_in">pi</span>;</span><br><span class="line">    Hz = freqz(B,A,wk);</span><br><span class="line">    <span class="built_in">plot</span>(wk/<span class="built_in">pi</span>, <span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(Hz)));</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;$20lg|Hg(\omega)|$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    title(<span class="string">&#x27;带通滤波器频谱特性&#x27;</span>);</span><br><span class="line">    axis([<span class="number">0.2</span>,<span class="number">0.9</span>,<span class="number">-80</span>,<span class="number">20</span>]);set(gca,<span class="string">&#x27;Xtick&#x27;</span>,<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>,<span class="string">&#x27;Ytick&#x27;</span>,<span class="number">-80</span>:<span class="number">20</span>:<span class="number">20</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(t, filter_bp_s);</span><br><span class="line">    xlabel(<span class="string">&#x27;t/s&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_bp_s);</span><br><span class="line">    title(<span class="string">&#x27;带通滤波后频域幅度特性&#x27;</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_bp_s_angle);</span><br><span class="line">    title(<span class="string">&#x27;带通滤波后频域相位特性&#x27;</span>);  </span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>ellipHighPass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ellipHighPass</span><span class="params">(fpz, fsz, rp, rs, x, fs, f1, Np, Alltitle)</span></span></span><br><span class="line">    wpz = <span class="number">2</span>*fpz/fs;</span><br><span class="line">    wsz = <span class="number">2</span>*fsz/fs;</span><br><span class="line">    [N, wn] = ellipord(wpz, wsz, rp, rs);    <span class="comment">% 获取阶数和截止频率</span></span><br><span class="line">    [B, A] = ellip(N, rp, rs, wn, <span class="string">&#x27;high&#x27;</span>);         <span class="comment">% 获得转移函数系数</span></span><br><span class="line"></span><br><span class="line">    filter_hp_s = filter(B, A, x);</span><br><span class="line">    X_hp_s = <span class="built_in">abs</span>(fft(filter_hp_s));</span><br><span class="line">    X_hp_s_angle = <span class="built_in">angle</span>(fft(filter_hp_s));</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% plot the graphs  </span></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    N = <span class="built_in">length</span>(x);    <span class="comment">% number of sampling points</span></span><br><span class="line">    f =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line"></span><br><span class="line">    <span class="comment">% 高通滤波器频谱特性</span></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>]);</span><br><span class="line">    M = <span class="number">512</span>;</span><br><span class="line">    wk = <span class="number">0</span>:<span class="built_in">pi</span>/M:<span class="built_in">pi</span>;</span><br><span class="line">    Hz = freqz(B,A,wk);</span><br><span class="line">    <span class="built_in">plot</span>(wk/<span class="built_in">pi</span>, <span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(Hz)));</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;$20lg|Hg(\omega)|$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    title(<span class="string">&#x27;高通滤波器频谱特性&#x27;</span>);</span><br><span class="line">    axis([<span class="number">0.2</span>,<span class="number">0.8</span>,<span class="number">-80</span>,<span class="number">20</span>]);</span><br><span class="line">    set(gca,<span class="string">&#x27;Xtick&#x27;</span>,<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>,<span class="string">&#x27;Ytick&#x27;</span>,<span class="number">-80</span>:<span class="number">20</span>:<span class="number">20</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(t, filter_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;高通滤波后时域图形&#x27;</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;t/s&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;高通滤波后频域幅度特性&#x27;</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s_angle);</span><br><span class="line">    title(<span class="string">&#x27;高通滤波后频域相位特性&#x27;</span>);  </span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>ellipLowPass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ellipLowPass</span><span class="params">(fpz, fsz, rp, rs, x, fs, f1, Np, Alltitle)</span></span></span><br><span class="line">    wpz = <span class="number">2</span>*fpz/fs;</span><br><span class="line">    wsz = <span class="number">2</span>*fsz/fs;</span><br><span class="line">    [N, wn] = ellipord(wpz, wsz, rp, rs);    <span class="comment">% 获取阶数和截止频率</span></span><br><span class="line">    [B, A] = ellip(N, rp, rs, wn, <span class="string">&#x27;low&#x27;</span>);         <span class="comment">% 获得转移函数系数</span></span><br><span class="line"></span><br><span class="line">    filter_hp_s = filter(B, A, x);</span><br><span class="line">    X_hp_s = <span class="built_in">abs</span>(fft(filter_hp_s));</span><br><span class="line">    X_hp_s_angle = <span class="built_in">angle</span>(fft(filter_hp_s));</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% plot the graphs  </span></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    N = <span class="built_in">length</span>(x);    <span class="comment">% number of sampling points</span></span><br><span class="line">    f =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line"></span><br><span class="line">    <span class="comment">% 低通滤波器频谱特性</span></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>]);</span><br><span class="line">    M = <span class="number">512</span>;</span><br><span class="line">    wk = <span class="number">0</span>:<span class="built_in">pi</span>/M:<span class="built_in">pi</span>;</span><br><span class="line">    Hz = freqz(B,A,wk);</span><br><span class="line">    <span class="built_in">plot</span>(wk/<span class="built_in">pi</span>, <span class="number">20</span> * <span class="built_in">log10</span>(<span class="built_in">abs</span>(Hz)));</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;$20lg|Hg(\omega)|$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    title(<span class="string">&#x27;低通滤波器频谱特性&#x27;</span>);</span><br><span class="line">    axis([<span class="number">0.2</span>,<span class="number">0.9</span>,<span class="number">-80</span>,<span class="number">20</span>]);</span><br><span class="line">    set(gca,<span class="string">&#x27;Xtick&#x27;</span>,<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>,<span class="string">&#x27;Ytick&#x27;</span>,<span class="number">-80</span>:<span class="number">20</span>:<span class="number">20</span>)</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(t, filter_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;低通滤波后时域图形&#x27;</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;t/s&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;低通滤波后频域幅度特性&#x27;</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s_angle);</span><br><span class="line">    title(<span class="string">&#x27;低通滤波后频域相位特性&#x27;</span>);   </span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>ellipBandStop</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ellipBandStop</span><span class="params">(fpl, fpu, fsl, fsu, rp, rs, x, fs, f1, Np, Alltitle)</span></span></span><br><span class="line">    wp = [<span class="number">2</span>*fpl/fs, <span class="number">2</span>*fpu/fs];</span><br><span class="line">    ws = [<span class="number">2</span>*fsl/fs, <span class="number">2</span>*fsu/fs];</span><br><span class="line">    [N, wn] = ellipord(wp, ws, rp, rs);    <span class="comment">% 获取阶数和截止频率</span></span><br><span class="line">    [B, A] = ellip(N, rp, rs, wn, <span class="string">&#x27;stop&#x27;</span>);         <span class="comment">% 获得转移函数系数</span></span><br><span class="line"></span><br><span class="line">    filter_bp_s = filter(B, A, x);</span><br><span class="line">    X_bp_s = <span class="built_in">abs</span>(fft(filter_bp_s));</span><br><span class="line">    X_bp_s_angle = <span class="built_in">angle</span>(fft(filter_bp_s));</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% plot the graphs  </span></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    N = <span class="built_in">length</span>(x);    <span class="comment">% number of sampling points</span></span><br><span class="line">    f =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line"></span><br><span class="line">    <span class="comment">% 带阻滤波器频谱特性</span></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>]);</span><br><span class="line">    M = <span class="number">512</span>;</span><br><span class="line">    wk = <span class="number">0</span>:<span class="built_in">pi</span>/M:<span class="built_in">pi</span>;</span><br><span class="line">    Hz = freqz(B,A,wk);</span><br><span class="line">    <span class="built_in">plot</span>(wk/<span class="built_in">pi</span>, <span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(Hz)));</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;$20lg|Hg(\omega)|$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    title(<span class="string">&#x27;带阻滤波器频谱特性&#x27;</span>);</span><br><span class="line">    axis([<span class="number">0.2</span>,<span class="number">0.9</span>,<span class="number">-80</span>,<span class="number">20</span>]);</span><br><span class="line">    set(gca,<span class="string">&#x27;Xtick&#x27;</span>,<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>,<span class="string">&#x27;Ytick&#x27;</span>,<span class="number">-80</span>:<span class="number">20</span>:<span class="number">20</span>);</span><br><span class="line">    grid on;</span><br><span class="line">   </span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(t, filter_bp_s);</span><br><span class="line">    title(<span class="string">&#x27;带阻滤波后时域图形&#x27;</span>);</span><br><span class="line">    xlabel(<span class="string">&#x27;t/s&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_bp_s);</span><br><span class="line">    title(<span class="string">&#x27;带阻滤波后频域幅度特性&#x27;</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_bp_s_angle);</span><br><span class="line">    title(<span class="string">&#x27;带阻滤波后频域相位特性&#x27;</span>);  </span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>firlHighPass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">firlHighPass</span><span class="params">(fpz, fsz, x, fs, f1, Np, Alltitle)</span></span></span><br><span class="line">    wpz = <span class="number">2</span> * <span class="built_in">pi</span> * fpz / fs;</span><br><span class="line">    wsz = <span class="number">2</span> * <span class="built_in">pi</span> * fsz / fs;</span><br><span class="line">    DB = wpz - wsz;              <span class="comment">% 计算过渡带宽度</span></span><br><span class="line">    N0 = <span class="built_in">ceil</span>(<span class="number">6.2</span> * <span class="built_in">pi</span> / DB);    <span class="comment">% 计算所需h(n)长度N0</span></span><br><span class="line">    N = N0 + <span class="built_in">mod</span>(N0 + <span class="number">1</span>, <span class="number">2</span>);     <span class="comment">% 确保h(n)长度N是奇数</span></span><br><span class="line"></span><br><span class="line">    wc = (wpz + wsz) /2 / <span class="built_in">pi</span>;    <span class="comment">% 计算理想高通滤波器通带截止频率</span></span><br><span class="line">    hn = fir1(N<span class="number">-1</span>, wc, <span class="string">&#x27;high&#x27;</span>, hamming(N));</span><br><span class="line"></span><br><span class="line">    filter_hp_s = filter(hn, <span class="number">1</span>, x);</span><br><span class="line">    X_hp_s = <span class="built_in">abs</span>(fft(filter_hp_s));</span><br><span class="line">    X_hp_s_angle = <span class="built_in">angle</span>(fft(filter_hp_s));</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% plot the graphs  </span></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    N = <span class="built_in">length</span>(x);    <span class="comment">% number of sampling points</span></span><br><span class="line">    f =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>]);</span><br><span class="line">    M = <span class="number">1024</span>;</span><br><span class="line">    k = <span class="number">1</span>:M / <span class="number">2</span>;</span><br><span class="line">    wk = <span class="number">2</span>*(<span class="number">0</span>:M/<span class="number">2</span><span class="number">-1</span>)/M;</span><br><span class="line">    Hz = freqz(hn, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">plot</span>(wk, <span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(Hz(k))));</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;$20lg|Hg(\omega)|$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    title(<span class="string">&#x27;高通滤波器频谱特性&#x27;</span>)</span><br><span class="line">    axis([<span class="number">0.2</span>,<span class="number">0.8</span>,<span class="number">-80</span>,<span class="number">20</span>]);</span><br><span class="line">    set(gca,<span class="string">&#x27;Xtick&#x27;</span>,<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>,<span class="string">&#x27;Ytick&#x27;</span>,<span class="number">-80</span>:<span class="number">20</span>:<span class="number">20</span>)</span><br><span class="line">    grid on;</span><br><span class="line">   </span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(t, filter_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;高通滤波后时域图形&#x27;</span>);</span><br><span class="line">    txt = xlabel(<span class="string">&#x27;t/s&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;高通滤波后频域幅度特性&#x27;</span>);</span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s_angle);</span><br><span class="line">    title(<span class="string">&#x27;高通滤波后频域相位特性&#x27;</span>);  </span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>firlLowPass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">firlLowPass</span><span class="params">(fpz, fsz, x, fs, f1, Np, Alltitle)</span></span></span><br><span class="line">    wpz = <span class="number">2</span> * <span class="built_in">pi</span> * fpz / fs;</span><br><span class="line">    wsz = <span class="number">2</span> * <span class="built_in">pi</span> * fsz / fs;</span><br><span class="line">    DB = wsz - wpz;         </span><br><span class="line">    N0 = <span class="built_in">ceil</span>(<span class="number">6.2</span> * <span class="built_in">pi</span> / DB);</span><br><span class="line">    N = N0 + <span class="built_in">mod</span>(N0 + <span class="number">1</span>, <span class="number">2</span>);   </span><br><span class="line"></span><br><span class="line">    wc = (wpz + wsz) / <span class="number">2</span> / <span class="built_in">pi</span>;</span><br><span class="line">    hn = fir1(N<span class="number">-1</span>, wc, <span class="string">&#x27;low&#x27;</span>, hamming(N));</span><br><span class="line"></span><br><span class="line">    filter_hp_s = filter(hn, <span class="number">1</span>, x);</span><br><span class="line">    X_hp_s = <span class="built_in">abs</span>(fft(filter_hp_s));</span><br><span class="line">    X_hp_s_angle = <span class="built_in">angle</span>(fft(filter_hp_s));</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% plot the graphs  </span></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    N = <span class="built_in">length</span>(x);    <span class="comment">% number of sampling points</span></span><br><span class="line">    f =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>]);</span><br><span class="line">    M = <span class="number">1024</span>;</span><br><span class="line">    k = <span class="number">1</span>:M / <span class="number">2</span>;</span><br><span class="line">    wk = <span class="number">2</span>*(<span class="number">0</span>:M/<span class="number">2</span><span class="number">-1</span>)/M;</span><br><span class="line">    Hz = freqz(hn, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">plot</span>(wk, <span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(Hz(k))));</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;$20lg|Hg(\omega)|$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    title(<span class="string">&#x27;低通滤波器频谱特性&#x27;</span>)</span><br><span class="line">    axis([<span class="number">0.2</span>,<span class="number">0.9</span>,<span class="number">-80</span>,<span class="number">20</span>]);</span><br><span class="line">    set(gca,<span class="string">&#x27;Xtick&#x27;</span>,<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>,<span class="string">&#x27;Ytick&#x27;</span>,<span class="number">-80</span>:<span class="number">20</span>:<span class="number">20</span>)</span><br><span class="line">    grid on;</span><br><span class="line">   </span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(t, filter_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;低通滤波后时域图形&#x27;</span>);</span><br><span class="line">    txt = xlabel(<span class="string">&#x27;t/s&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;低通滤波后频域幅度特性&#x27;</span>);</span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s_angle);</span><br><span class="line">    title(<span class="string">&#x27;低通滤波后频域相位特性&#x27;</span>);  </span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>firlBandPass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">firlBandPass</span><span class="params">(fpl, fpu, x, fs, f1, Np, Alltitle)</span></span></span><br><span class="line">    wpl = <span class="number">2</span> * fpl / fs;</span><br><span class="line">    wpu = <span class="number">2</span> * fpu / fs;</span><br><span class="line">    fpass = [wpl, wpu];</span><br><span class="line">    N = <span class="number">111</span>;</span><br><span class="line">    hn = fir1(N<span class="number">-1</span>, fpass, <span class="string">&#x27;bandpass&#x27;</span>, hamming(N));</span><br><span class="line"></span><br><span class="line">    filter_hp_s = filter(hn, <span class="number">1</span>, x);</span><br><span class="line">    X_hp_s = <span class="built_in">abs</span>(fft(filter_hp_s));</span><br><span class="line">    X_hp_s_angle = <span class="built_in">angle</span>(fft(filter_hp_s));</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% plot the graphs  </span></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    N = <span class="built_in">length</span>(x);    <span class="comment">% number of sampling points</span></span><br><span class="line">    f =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>]);</span><br><span class="line">    M = <span class="number">1024</span>;</span><br><span class="line">    k = <span class="number">1</span>:M / <span class="number">2</span>;</span><br><span class="line">    wk = <span class="number">2</span>*(<span class="number">0</span>:M/<span class="number">2</span><span class="number">-1</span>)/M;</span><br><span class="line">    Hz = freqz(hn, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">plot</span>(wk, <span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(Hz(k))));</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;$20lg|Hg(\omega)|$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    title(<span class="string">&#x27;带通滤波器频谱特性&#x27;</span>)</span><br><span class="line">    axis([<span class="number">0.2</span>,<span class="number">0.9</span>,<span class="number">-80</span>,<span class="number">20</span>]);</span><br><span class="line">    set(gca,<span class="string">&#x27;Xtick&#x27;</span>,<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>,<span class="string">&#x27;Ytick&#x27;</span>,<span class="number">-80</span>:<span class="number">20</span>:<span class="number">20</span>)</span><br><span class="line">    grid on;</span><br><span class="line">   </span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(t, filter_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;带通滤波后时域图形&#x27;</span>);</span><br><span class="line">    txt = xlabel(<span class="string">&#x27;t/s&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;带通滤波后频域幅度特性&#x27;</span>);</span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s_angle);</span><br><span class="line">    title(<span class="string">&#x27;带通滤波后频域相位特性&#x27;</span>);  </span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight matlab"><figcaption><span>firlBandStop</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">firlBandStop</span><span class="params">(fsl, fsu, x, fs, f1, Np, Alltitle)</span></span></span><br><span class="line">    wsl = <span class="number">2</span> * fsl / fs;</span><br><span class="line">    wsu = <span class="number">2</span> * fsu / fs;</span><br><span class="line">    fstop = [wsl, wsu];</span><br><span class="line">    N = <span class="number">111</span>;</span><br><span class="line">    hn = fir1(N<span class="number">-1</span>, fstop, <span class="string">&#x27;stop&#x27;</span>, hamming(N));</span><br><span class="line"></span><br><span class="line">    filter_hp_s = filter(hn, <span class="number">1</span>, x);</span><br><span class="line">    X_hp_s = <span class="built_in">abs</span>(fft(filter_hp_s));</span><br><span class="line">    X_hp_s_angle = <span class="built_in">angle</span>(fft(filter_hp_s));</span><br><span class="line">  </span><br><span class="line">    <span class="comment">% plot the graphs  </span></span><br><span class="line">    period = <span class="number">1</span>/f1;        <span class="comment">% the period of analog signal(assuming f1 is the minimal)</span></span><br><span class="line">    T = Np*period;         <span class="comment">% sampling time-domain window(several periods)</span></span><br><span class="line">    Ts = <span class="number">1</span> / fs;          <span class="comment">% sampling timestep</span></span><br><span class="line">    t = <span class="number">0</span>: Ts : T;       <span class="comment">% samping sequence of discrete sampling points</span></span><br><span class="line">    N = <span class="built_in">length</span>(x);    <span class="comment">% number of sampling points</span></span><br><span class="line">    f =  <span class="number">2</span>*(<span class="number">0</span>:N<span class="number">-1</span>)/N;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">figure</span>(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">210</span>, <span class="number">80</span>, <span class="number">950</span>, <span class="number">750</span>]);</span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>]);</span><br><span class="line">    M = <span class="number">1024</span>;</span><br><span class="line">    k = <span class="number">1</span>:M / <span class="number">2</span>;</span><br><span class="line">    wk = <span class="number">2</span>*(<span class="number">0</span>:M/<span class="number">2</span><span class="number">-1</span>)/M;</span><br><span class="line">    Hz = freqz(hn, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">plot</span>(wk, <span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(Hz(k))));</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylabel(<span class="string">&#x27;$20lg|Hg(\omega)|$&#x27;</span>, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    title(<span class="string">&#x27;带阻滤波器频谱特性&#x27;</span>)</span><br><span class="line">    axis([<span class="number">0.2</span>,<span class="number">0.9</span>,<span class="number">-80</span>,<span class="number">20</span>]);</span><br><span class="line">    set(gca,<span class="string">&#x27;Xtick&#x27;</span>,<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>,<span class="string">&#x27;Ytick&#x27;</span>,<span class="number">-80</span>:<span class="number">20</span>:<span class="number">20</span>)</span><br><span class="line">    grid on;</span><br><span class="line">   </span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(t, filter_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;带阻滤波后时域图形&#x27;</span>);</span><br><span class="line">    txt = xlabel(<span class="string">&#x27;t/s&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s);</span><br><span class="line">    title(<span class="string">&#x27;带阻滤波后频域幅度特性&#x27;</span>);</span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line"></span><br><span class="line">    subplot(<span class="number">4</span>,<span class="number">4</span>,[<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>]);</span><br><span class="line">    <span class="built_in">plot</span>(f, X_hp_s_angle);</span><br><span class="line">    title(<span class="string">&#x27;带阻滤波后频域相位特性&#x27;</span>);  </span><br><span class="line">    txt = ylabel(<span class="string">&#x27;Phase&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    ylim([<span class="number">-3.5</span>, <span class="number">3.5</span>]);</span><br><span class="line">    xlabel(<span class="string">&#x27;\omega/\pi&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    set(txt, <span class="string">&#x27;Interpreter&#x27;</span>, <span class="string">&#x27;latex&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">    grid on;</span><br><span class="line">    sgtitle(Alltitle, <span class="string">&#x27;FontName&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="数字信号处理学习笔记"><a href="#数字信号处理学习笔记" class="headerlink" title="数字信号处理学习笔记"></a>数字信号处理学习笔记</h2><article class="message is-info">
        
        <div class="message-body">
            <p>本章节主要是在课程学习过程中整理出的笔记文档。</p>

        </div>
    </article>
<div style="border: 1px solid #ccc; padding: 15px; border-radius: 5px; box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); margin-bottom: 15px;">
    <p>数字信号处理学习笔记，计算机科学与技术嵌入式系统方向，西安电子科技大学</p>
    <p>
        <a target="_blank" rel="noopener" href="https://github.com/LZHMS/LZHMS.github.io/blob/deploy/pdf/collaboration/DigitalSignalProcessingNotes.pdf">
            https://github.com/LZHMS/LZHMS.github.io/blob/deploy/pdf/collaboration/DigitalSignalProcessingNotes.pdf
        </a>
    </p>
</div>


<h2 id="Contributors"><a href="#Contributors" class="headerlink" title="Contributors"></a>Contributors</h2><div style="border: 1px solid #ccc; padding: 15px; border-radius: 5px; box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); margin-bottom: 15px;">
    <p>Zhihao Li, Computer Science and Technology, Xidian University</p>
    <p>
        <a target="_blank" rel="noopener" href="https://zhihaoli.top">
            https://zhihaoli.top
        </a>
    </p>
</div>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><div style="border: 1px solid #ccc; padding: 15px; border-radius: 5px; box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);">
    <p>王文俊. 2023年秋, 数字信号处理, 西安电子科技大学.</p>
    <p>
        <a target="_blank" rel="noopener" href="https://mooc1.chaoxing.com/mooc-ans/course/236249651.html">
            https://mooc1.chaoxing.com/mooc-ans/course/236249651.html
        </a>
    </p>
</div></div><div class="article-licensing box"><div class="licensing-title"><p>Signal Filters Design Based on Digital Signal Processing</p><p><a href="https://lzhms.github.io/collaboration/DigitalSignalProcessing/">https://lzhms.github.io/collaboration/DigitalSignalProcessing/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Zhihao Li</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-10-24</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-11-30</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Collaboration-Project/">Collaboration Project </a></div></div><div class="sharethis-inline-reaction-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=6713c7a4f9d5250012f5d817&amp;product=inline-reaction-buttons&amp;source=platform" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/essay/HealthAndLife/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">关于生命与健康的一些思考</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/blog/OpenSSLConnectionWithGithub/"><span class="level-item">Solution to OpenSSL Connection Problems With Github</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="content twikoo" id="twikoo"></div><script src="https://cdnjs.loli.net/ajax/libs/twikoo/1.6.30/twikoo.all.min.js"></script><script>twikoo.init({
            envId: 'https://twikoo-netlify-comment.netlify.app/.netlify/functions/twikoo',
            region: "ap-guangzhou",
            lang: "en",
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-96x96 mx-auto mb-2"><img class="avatar is-rounded" src="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/blog/profile/avatar.png" alt="Zhihao Li"></figure><p class="title is-size-4 is-block" style="line-height: 'inherit';">Zhihao Li</p><p style="white-space: pre-line; font-style: italic; margin-bottom: 0.50rem; font-size: 1.0em">Computer Science
Machine Learning
</p><p class="is-size-5 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Xidian University, Xi&#039;an, China</span></p></div></div></nav><nav class="level menu-list is-mobile" style="margin-bottom:1rem"><a class="level-item has-text-centered is-marginless" href="/archives/"><div><p class="heading">Posts</p><div><p class="title">54</p></div></div></a><a class="level-item has-text-centered is-marginless" href="/categories/"><div><p class="heading">Categories</p><div><p class="title">6</p></div></div></a><a class="level-item has-text-centered is-marginless" href="/tags/"><div><p class="heading">Tags</p><div><p class="title">40</p></div></div></a></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/LZHMS" target="_blank" rel="noopener"><i class="fab fa-github"></i>  Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Bilibili" href="https://space.bilibili.com/2079836440"><i class="iconfont icon-bilibili"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="QQ" href="https://jsd.cdn.zzko.cn/gh/LZHMS/picx-images-hosting@master/Profile/1730463517285_temp_qrcode_share_9993.64dv175zqu.webp"><i class="iconfont icon-QQ1"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="WeChat" href="https://jsd.cdn.zzko.cn/gh/LZHMS/picx-images-hosting@master/Profile/0add852711e38990022788ba88dd062.3nrmm9y3ql.webp"><i class="iconfont icon-wechat-"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:zhihaoli@stu.xidian.edu.cn"><i class="iconfont icon-email2"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Transcript" href="/./pdf/profile/transcript.pdf"><i class="iconfont icon-chengjidan1"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Thoeries"><span class="level-left"><span class="level-item">1</span><span class="level-item">Thoeries</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#I-Fourier-Series-Expansion-Algorithm"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">I. Fourier Series Expansion Algorithm</span></span></a></li><li><a class="level is-mobile" href="#II-Sample-the-Analog-Signal"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">II. Sample the Analog Signal</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Time-Domain-Sampling-Theorem"><span class="level-left"><span class="level-item">1.2.1</span><span class="level-item">Time Domain Sampling Theorem</span></span></a></li><li><a class="level is-mobile" href="#Time-domain-Window"><span class="level-left"><span class="level-item">1.2.2</span><span class="level-item">Time-domain Window</span></span></a></li><li><a class="level is-mobile" href="#Sampling-Frequency"><span class="level-left"><span class="level-item">1.2.3</span><span class="level-item">Sampling Frequency</span></span></a></li><li><a class="level is-mobile" href="#Spectral-Resolution"><span class="level-left"><span class="level-item">1.2.4</span><span class="level-item">Spectral Resolution</span></span></a></li></ul></li><li><a class="level is-mobile" href="#III-Spectral-Analysis"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">III. Spectral Analysis</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Convert-to-Frequency"><span class="level-left"><span class="level-item">1.3.1</span><span class="level-item">Convert to Frequency</span></span></a></li><li><a class="level is-mobile" href="#Convert-to-Real-Amplitude"><span class="level-left"><span class="level-item">1.3.2</span><span class="level-item">Convert to Real Amplitude</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#Experiments"><span class="level-left"><span class="level-item">2</span><span class="level-item">Experiments</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Experiment-I-T-p-3T-c-F-s-90-Hz"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Experiment I: $T_p=3T_c, F_s=90$Hz</span></span></a></li><li><a class="level is-mobile" href="#Experiment-II-T-p-3T-c-F-s-60-Hz"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Experiment II: $T_p=3T_c, F_s=60$Hz</span></span></a></li><li><a class="level is-mobile" href="#Experiment-III-T-p-3T-c-F-s-40-Hz"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Experiment III: $T_p=3T_c, F_s=40$Hz</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Results"><span class="level-left"><span class="level-item">3</span><span class="level-item">Results</span></span></a></li><li><a class="level is-mobile" href="#Codes"><span class="level-left"><span class="level-item">4</span><span class="level-item">Codes</span></span></a></li><li><a class="level is-mobile" href="#数字信号处理学习笔记"><span class="level-left"><span class="level-item">5</span><span class="level-item">数字信号处理学习笔记</span></span></a></li><li><a class="level is-mobile" href="#Contributors"><span class="level-left"><span class="level-item">6</span><span class="level-item">Contributors</span></span></a></li><li><a class="level is-mobile" href="#Reference"><span class="level-left"><span class="level-item">7</span><span class="level-item">Reference</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/blog/"><span class="level-start"><span class="level-item">blog</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/collaboration/"><span class="level-start"><span class="level-item">collaboration</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/essay/"><span class="level-start"><span class="level-item">essay</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/knowledge/"><span class="level-start"><span class="level-item">knowledge</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/projects/"><span class="level-start"><span class="level-item">projects</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/readings/"><span class="level-start"><span class="level-item">readings</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Embedded-System/"><span class="tag">Embedded System</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Project-Tools/"><span class="tag">Project Tools</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Diffusion-Model/"><span class="tag">Diffusion Model</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AIGC/"><span class="tag">AIGC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Project-Habits/"><span class="tag">Project Habits</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mathematical-Modeling/"><span class="tag">Mathematical Modeling</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Visualization/"><span class="tag">Data Visualization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenSSL/"><span class="tag">OpenSSL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Research-Habits/"><span class="tag">Research Habits</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Computer-Network/"><span class="tag">Computer Network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Collaboration-Project/"><span class="tag">Collaboration Project</span><span class="tag">6</span></a></div></div><div class="more-link"><a href="/tags/">View All Tags &gt;&gt;</a></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/blog/profile/logo_light.png" alt="Zhihao Li - Zhihao Li&#039;s Blog" height="28"><img class="logo-img-dark" src="https://lzhms.oss-cn-hangzhou.aliyuncs.com/images/blog/profile/logo_dark.png" alt="Zhihao Li - Zhihao Li&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023-2024 Zhihao Li</span><br><span id="busuanzi_container_site_uv"><span id="busuanzi_container_site_uv">Site UV: <span id="busuanzi_value_site_uv"></span></span>   <span id="busuanzi_container_site_pv">Site PV: <span id="busuanzi_value_site_pv"></span></span></span></p><p class="is-size-7"> </p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="HuggingFace" href="https://huggingface.co/LZHMS"><i class="iconfont icon-huggingface"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="ZhiHu" href="https://www.zhihu.com/people/zhao.li"><i class="iconfont icon-zhihu"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="CSDN" href="https://blog.csdn.net/weixin_63554791"><i class="iconfont icon-csdn"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><!--!--><script data-pjax src="/js/main.js" defer></script><script data-pjax src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><div id="dark" onclick="switchDarkMode()"></div><script type="text/javascript" src="/js/universe.js"></script></body></html>